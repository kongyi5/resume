{"version":3,"sources":["js/message.js"],"names":["model","init","AV","appId","appKey","serverURL","fetch","query","Query","find","save","name","content","Message","Object","extend","message","view","document","querySelector","controller","messageList","form","bindEvents","loadMessages","then","messages","array","map","item","attributes","forEach","li","createElement","innerText","appendChild","addEventListener","e","preventDefault","saveMessage","myForm","value","alert","object","error","console","log","call"],"mappings":"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","file":"message.2c04185c.js","sourceRoot":"..\\src","sourcesContent":["!function () {\r\n  let model = {\r\n    init: function () {\r\n      AV.init({\r\n        appId: \"6QEhBTOEUrHYTwQvuKyrn0rT-gzGzoHsz\",\r\n        appKey: \"BmT8ng5MmIRlQvDltuvys8Ro\",\r\n        serverURL: \"https://6qehbtoe.lc-cn-n1-shared.com\",\r\n      });\r\n    },\r\n    // 获取数据\r\n    fetch: () => {\r\n      let query = new AV.Query(\"message\");\r\n      return query.find(); // Promise 对象\r\n    },\r\n    // 创建数据\r\n    save: (name, content) => {\r\n      let Message = AV.Object.extend(\"message\"); //连接对应数据库名字\r\n      let message = new Message();\r\n      return message.save({\r\n        //要存的信息\r\n        name: name,\r\n        content: content,\r\n      });\r\n    },\r\n  };\r\n  var view = document.querySelector(\"section.message\");\r\n\r\n  var controller = {\r\n    view: null,\r\n    model: null,\r\n    messageList: null,\r\n    init: function (view, model) {\r\n      this.view = view;\r\n      this.model = model;\r\n\r\n      this.messageList = view.querySelector(\"#messageList\");\r\n      this.form = view.querySelector(\"#postMessageForm\");\r\n      this.model.init();\r\n      this.bindEvents();\r\n      this.loadMessages();\r\n    },\r\n    loadMessages: function () {\r\n      this.model.fetch().then((messages) => {\r\n        let array = messages.map((item) => {\r\n          return item.attributes;\r\n        });\r\n        array.forEach((item) => {\r\n          let li = document.createElement(\"li\");\r\n          li.innerText = `${item.name}: ${item.content}`;\r\n          this.messageList.appendChild(li);\r\n        });\r\n      });\r\n    },\r\n    bindEvents: function () {\r\n      this.form.addEventListener(\"submit\", (e) => {\r\n        e.preventDefault();\r\n        this.saveMessage();\r\n      });\r\n    },\r\n    saveMessage: function () {\r\n      let myForm = this.form;\r\n      let name = myForm.querySelector(\"input[name=name]\").value;\r\n      let content = myForm.querySelector(\"input[name=content]\").value;\r\n      if (name === \"\" && content === \"\") {\r\n        alert(\"你是谁？想说啥？\");\r\n      } else if (name === \"\") {\r\n        alert(\"你是谁？\");\r\n      } else if (content === \"\") {\r\n        alert(\"想说啥？\");\r\n      } else {\r\n        this.model.save(name, content).then(\r\n          (object) => {\r\n            let li = document.createElement(\"li\");\r\n            li.innerText = `${object.attributes.name}: ${object.attributes.content}`;\r\n            this.messageList.appendChild(li);\r\n            myForm.querySelector(\"input[name=content]\").value = \"\";\r\n          },\r\n          (error) => console.log(error)\r\n        );\r\n      }\r\n    },\r\n  };\r\n  controller.init(view, model);\r\n}.call();\r\n"]}